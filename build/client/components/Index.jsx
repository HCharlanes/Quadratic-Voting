Index = React.createClass({

	getInitialState: function() {
		return {
			field: ''
		};
	},

	onFieldChange(event) {
		this.setState({
			field: event.target.value
		});
	},

	onCreateOrganization(event) {

		event.preventDefault();

		Organization.new({
			data: '6060604052606460066000505560006007600050555b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690830217905550600060056000508190555060006004600050819055505b6117e8806100656000396000f3606060405236156100f8576000357c010000000000000000000000000000000000000000000000000000000090048063013cf08b146100fa57806308ae4b0c1461013c57806308d103f7146101685780630b1ca49a146101945780631cdc044b146101ac57806323b161ab146101cf57806327e235e3146101f25780632d87017c1461021e578063400e394914610241578063446a37e0146102645780634698d1101461027c578063612032651461029f57806361ebccfd146102d8578063790b71331461030257806383197ef014610323578063c34c356f14610332578063ca6d56dc1461034a578063d8af4d0e14610362576100f8565b005b6101106004808035906020019091905050610974565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b61015260048080359060200190919050506108ec565b6040518082815260200191505060405180910390f35b61017e600480803590602001909190505061092c565b6040518082815260200191505060405180910390f35b6101aa60048080359060200190919050506104c5565b005b6101b96004805050610959565b6040518082815260200191505060405180910390f35b6101dc6004805050610950565b6040518082815260200191505060405180910390f35b6102086004808035906020019091905050610911565b6040518082815260200191505060405180910390f35b61022b6004805050610962565b6040518082815260200191505060405180910390f35b61024e600480505061096b565b6040518082815260200191505060405180910390f35b61027a6004808035906020019091905050610dd0565b005b6102896004805050610947565b6040518082815260200191505060405180910390f35b6102ac60048050506108c6565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b6103006004808035906020019091908035906020019091908035906020019091905050610688565b005b6103216004808035906020019091908035906020019091905050610635565b005b6103306004805050610fb3565b005b6103486004808035906020019091905050610bb4565b005b61036060048080359060200190919050506103ca565b005b6103c86004808035906020019082018035906020019191908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509090919080359060200190919080359060200190919050506109b6565b005b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515610426576104c2565b6001600160005060008373ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083021790555060046000818150548092919060010191905055506000600260005060008373ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600050819055506104c160066000505482610635565b5b50565b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415806105595750600160005060008273ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16155b1561056357610632565b6000600160005060008373ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff02191690830217905550600460008181505480929190600190039190505550600260005060008273ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000505460056000828282505403925050819055506000600260005060008373ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600050819055505b50565b81600560008282825054019250508190555081600260005060008373ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828282505401925050819055505b5050565b6000600160005060003373ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff1615156106cf576108c0565b6001600260005060003373ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060005054101561070c576108c0565b600183101561071a576108c0565b600260005060003373ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600050548384021115610758576108c0565b8190508073ffffffffffffffffffffffffffffffffffffffff166309eef43e33604051827c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1681526020019150506020604051808303816000876161da5a03f1156100025750505060405180519060200150156107ee576108c0565b828302600260005060003373ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828282505403925050819055508073ffffffffffffffffffffffffffffffffffffffff166361ebccfd858533604051847c0100000000000000000000000000000000000000000000000000000000028152600401808481526020018381526020018273ffffffffffffffffffffffffffffffffffffffff16815260200193505050506000604051808303816000876161da5a03f115610002575050506108c0565b50505050565b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600160005060205280600052604060002060009150909054906101000a900460ff1681565b60026000506020528060005260406000206000915090505481565b60036000506020528060005260406000206000915090505481565b60046000505481565b60056000505481565b60066000505481565b60076000505481565b60086000505481565b600960005081815481101561000257906000526020600020900160005b9150909054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6000600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515610a1457610bae565b6007600050544201831015610a2857610bae565b8383836040516107a18061104783390180806020018481526020018381526020018281038252858181518152602001915080519060200190808383829060006004602084601f0104600f02600301f150905090810190601f168015610aa15780820380516001836020036101000a031916815260200191505b50945050505050604051809103906000f0905060096000508054806001018281815481835581811511610b0657818360005260206000209182019101610b059190610ae7565b80821115610b015760008181506000905550600101610ae7565b5090565b5b5050509190906000526020600020900160005b83909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908302179055505060086000818150548092919060010191905055507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff600360005060008373ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600050819055505b50505050565b60006000829150600090505b8173ffffffffffffffffffffffffffffffffffffffff1663bfcddbbc604051817c01000000000000000000000000000000000000000000000000000000000281526004018090506020604051808303816000876161da5a03f11561000257505050604051805190602001508160ff161015610dca578173ffffffffffffffffffffffffffffffffffffffff1663bfcddbbc604051817c01000000000000000000000000000000000000000000000000000000000281526004018090506020604051808303816000876161da5a03f11561000257505050604051805190602001508273ffffffffffffffffffffffffffffffffffffffff16633d79d1c8604051817c01000000000000000000000000000000000000000000000000000000000281526004018090506020604051808303816000876161da5a03f115610002575050506040518051906020015004600260005060008473ffffffffffffffffffffffffffffffffffffffff1663da58c7d985604051827c0100000000000000000000000000000000000000000000000000000000028152600401808260ff1681526020019150506020604051808303816000876161da5a03f115610002575050506040518051906020015073ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828282505401925050819055505b8080600101915050610bc0565b5b505050565b60007fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff600360005060008473ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060005054141515610e2f57610faf565b8190508073ffffffffffffffffffffffffffffffffffffffff16633197cbb6604051817c01000000000000000000000000000000000000000000000000000000000281526004018090506020604051808303816000876161da5a03f115610002575050506040518051906020015042101515610fae578073ffffffffffffffffffffffffffffffffffffffff166394f0873d604051817c01000000000000000000000000000000000000000000000000000000000281526004018090506020604051808303816000876161da5a03f1156100025750505060405180519060200150600360005060008473ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060005081905550610f4c82610bb4565b8073ffffffffffffffffffffffffffffffffffffffff166383197ef0604051817c01000000000000000000000000000000000000000000000000000000000281526004018090506000604051808303816000876161da5a03f115610002575050505b5b5050565b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141561104457600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16ff5b5b5660606040526040516107a13803806107a1833981016040528080518201919060200180519060200190919080519060200190919050505b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908302179055508260016000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106100b057805160ff19168380011785556100e1565b828001600101855582156100e1579182015b828111156100e05782518260005055916020019190600101906100c2565b5b50905061010c91906100ee565b8082111561010857600081815060009055506001016100ee565b5090565b505081600760005081905550806008600050819055505b50505061066d806101346000396000f3606060405236156100b6576000357c01000000000000000000000000000000000000000000000000000000009004806306fdde03146100b857806309eef43e146101335780633197cbb61461015f5780633d79d1c81461018257806361ebccfd146101a557806378e97925146101cf57806383197ef0146101f257806394f0873d14610201578063bd108fd414610224578063bfcddbbc14610247578063d6b225be1461026a578063da58c7d91461028d576100b6565b005b6100c5600480505061039e565b60405180806020018281038252838181518152602001915080519060200190808383829060006004602084601f0104600f02600301f150905090810190601f1680156101255780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b610149600480803590602001909190505061043f565b6040518082815260200191505060405180910390f35b61016c60048050506104ca565b6040518082815260200191505060405180910390f35b61018f60048050506104b8565b6040518082815260200191505060405180910390f35b6101cd60048080359060200190919080359060200190919080359060200190919050506104dc565b005b6101dc60048050506104c1565b6040518082815260200191505060405180910390f35b6101ff600480505061030a565b005b61020e60048050506102cf565b6040518082815260200191505060405180910390f35b61023160048050506104a6565b6040518082815260200191505060405180910390f35b61025460048050506104d3565b6040518082815260200191505060405180910390f35b61027760048050506104af565b6040518082815260200191505060405180910390f35b6102a36004808035906020019091905050610464565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b60006008600050544210156102e357610307565b60056000505460046000505411156102fe5760019050610307565b60009050610307565b90565b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141561039b57600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16ff5b5b565b60016000508054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156104375780601f1061040c57610100808354040283529160200191610437565b820191906000526020600020905b81548152906001019060200180831161041a57829003601f168201915b505050505081565b600260005060205280600052604060002060009150909054906101000a900460ff1681565b600360005081815481101561000257906000526020600020900160005b9150909054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60046000505481565b60056000505481565b60066000505481565b60076000505481565b60086000505481565b60096000505481565b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561053857610668565b6001600260005060008373ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff02191690830217905550600360005080548060010182818154818355818115116105cd578183600052602060002091820191016105cc91906105ae565b808211156105c857600081815060009055506001016105ae565b5090565b5b5050509190906000526020600020900160005b83909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908302179055505081820260066000828282505401925050819055506009600081815054809291906001019190505550821561065157816004600082828250540192505081905550610668565b816005600082828250540192505081905550610668565b50505056',
			from: web3.eth.accounts[0]
		},
		function(err, myContract) {
			if (!err) {
				// NOTE: The callback will fire twice!
				// Once the contract has the transactionHash property set and once its deployed on an address.

				// e.g. check tx hash on the first call (transaction send)
				if (!myContract.address) {
					// check address on the second call (contract deployed)
				} else {
					console.log(myContract.address)
					var organizationAddress = myContract.address
					//console.log("num", myContract.proposals(0).toString())

					myContract.makeProposal("Buy more beer", moment().add(10, 's').unix(), moment().add(1,'day').unix(), {
						from: web3.eth.accounts[0]
					});
					//console.log("num", myContract.proposals(0).toString())

					myContract.makeProposal("Install solar panels", moment().add(10, 's').unix(), moment().add(1,'day').unix(), {
						from: web3.eth.accounts[0]
					});
					//console.log("num", myContract.proposals(0).toString())

					FlowRouter.go("/orgs/" + organizationAddress + "/proposals")

				}
			} else {
				console.log("Err", err);
				Meteor.disconnect();
			}
		});
	},

	render: function() {

		let {field} = this.state

		return (
		<form onSubmit={this.onCreateOrganization}>
	        Create Organization:
	        <input type="text" name="value" value={field} onChange={this.onFieldChange}></input>
	        <input type="submit"></input>
	     </form>  
		);
	}

});